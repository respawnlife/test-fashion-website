# æ—¶å°šç½‘ç«™åç«¯ç³»ç»Ÿ

ä¸ºæ—¶å°šå¥³è£…å’Œé‹åŒ…äº§å“å±•ç¤ºç½‘ç«™æä¾›çš„å®Œæ•´åç«¯è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ç®¡ç†åå°ã€å•†å“çˆ¬è™«ç³»ç»Ÿå’Œ API æ¥å£ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… JWT Token è®¤è¯
- âœ… ç®¡ç†å‘˜è´¦å· (moo / mootest1212)
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ (bcrypt)
- âœ… è§’è‰²æƒé™æ§åˆ¶
- âœ… æ“ä½œæ—¥å¿—è®°å½•

### 2. å•†å“ç®¡ç†
- âœ… å•†å“ CRUD æ“ä½œ
- âœ… å•†å“åˆ†ç±» (å¥³è£…/é‹å­/åŒ…åŒ…)
- âœ… å•†å“æœç´¢å’Œç­›é€‰
- âœ… æ¨èå•†å“æ ‡è®°
- âœ… ä¸Šä¸‹æ¶ç®¡ç†
- âœ… å›¾ç‰‡ç®¡ç†

### 3. çˆ¬è™«ç³»ç»Ÿ
- âœ… robots.txt åˆè§„æ£€æŸ¥
- âœ… è‡ªåŠ¨çˆ¬å–å•†å“ä¿¡æ¯
- âœ… å®šæ—¶ä»»åŠ¡è°ƒåº¦
- âœ… çˆ¬å–æ—¥å¿—è®°å½•
- âœ… å»é‡æœºåˆ¶
- âœ… å¹¶å‘æ§åˆ¶

### 4. ç®¡ç†åå°
- âœ… ä»ªè¡¨ç›˜
- âœ… å•†å“ç®¡ç†ç•Œé¢
- âœ… çˆ¬è™«ä»»åŠ¡ç®¡ç†
- âœ… ç”¨æˆ·ç®¡ç†
- âœ… æ“ä½œæ—¥å¿—æŸ¥çœ‹
- âœ… å¯†ç ä¿®æ”¹

### 5. API æ¥å£
- âœ… RESTful API è®¾è®¡
- âœ… åˆ†é¡µå’Œç­›é€‰
- âœ… é€Ÿç‡é™åˆ¶
- âœ… é”™è¯¯å¤„ç†
- âœ… CORS æ”¯æŒ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: Node.js 18+
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“**: SQLite (better-sqlite3)
- **è®¤è¯**: JWT + bcrypt
- **çˆ¬è™«**: Cheerio + Axios
- **æ—¥å¿—**: Winston
- **å®šæ—¶ä»»åŠ¡**: node-cron
- **ç®¡ç†åå°**: React + Vite

## ğŸ“¦ å®‰è£…

### 1. å®‰è£…åç«¯ä¾èµ–

```bash
cd backend
yarn install
```

### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
yarn init-db
```

### 3. åˆ›å»ºç®¡ç†å‘˜è´¦å·

```bash
yarn seed-admin
```

### 4. å®‰è£…ç®¡ç†åå°ä¾èµ–

```bash
cd admin
yarn install
```

### 5. æ„å»ºç®¡ç†åå°

```bash
yarn build
```

## ğŸš€ å¯åŠ¨

### å¼€å‘æ¨¡å¼

```bash
# ç»ˆç«¯ 1: å¯åŠ¨åç«¯
cd backend
yarn dev

# ç»ˆç«¯ 2: å¯åŠ¨ç®¡ç†åå°å¼€å‘æœåŠ¡å™¨
cd backend/admin
yarn dev
```

### ç”Ÿäº§æ¨¡å¼

```bash
# æ„å»ºç®¡ç†åå°
cd backend/admin
yarn build

# å¯åŠ¨åç«¯æœåŠ¡
cd backend
yarn start
```

æœåŠ¡å°†åœ¨ http://localhost:3000 å¯åŠ¨
ç®¡ç†åå°è®¿é—®ï¼šhttp://localhost:3000/admin
API æ–‡æ¡£ï¼šhttp://localhost:3000/api

## ğŸ“‹ API æ¥å£

### è®¤è¯æ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | /api/auth/login | ç™»å½• |
| POST | /api/auth/logout | ç™»å‡º |
| GET | /api/auth/profile | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| PUT | /api/auth/password | ä¿®æ”¹å¯†ç  |

### å•†å“æ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | /api/products | è·å–å•†å“åˆ—è¡¨ |
| GET | /api/products/:id | è·å–å•†å“è¯¦æƒ… |
| POST | /api/products | åˆ›å»ºå•†å“ (éœ€è¦ç®¡ç†å‘˜) |
| PUT | /api/products/:id | æ›´æ–°å•†å“ (éœ€è¦ç®¡ç†å‘˜) |
| DELETE | /api/products/:id | åˆ é™¤å•†å“ (éœ€è¦ç®¡ç†å‘˜) |
| PATCH | /api/products/:id/active | åˆ‡æ¢ä¸Šä¸‹æ¶çŠ¶æ€ |
| PATCH | /api/products/:id/featured | åˆ‡æ¢æ¨èçŠ¶æ€ |

### ç”¨æˆ·æ¥å£ (éœ€è¦ç®¡ç†å‘˜)

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | /api/users | è·å–ç”¨æˆ·åˆ—è¡¨ |
| GET | /api/users/:id | è·å–ç”¨æˆ·è¯¦æƒ… |
| POST | /api/users | åˆ›å»ºç”¨æˆ· |
| PUT | /api/users/:id | æ›´æ–°ç”¨æˆ· |
| DELETE | /api/users/:id | åˆ é™¤ç”¨æˆ· |
| GET | /api/users/logs/admin | è·å–ç®¡ç†å‘˜æ“ä½œæ—¥å¿— |

### çˆ¬è™«æ¥å£ (éœ€è¦ç®¡ç†å‘˜)

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | /api/crawler/tasks | è·å–çˆ¬è™«ä»»åŠ¡åˆ—è¡¨ |
| GET | /api/crawler/tasks/:id | è·å–ä»»åŠ¡è¯¦æƒ… |
| GET | /api/crawler/tasks/:id/logs | è·å–ä»»åŠ¡æ—¥å¿— |
| POST | /api/crawler/tasks | åˆ›å»ºçˆ¬è™«ä»»åŠ¡ |
| PUT | /api/crawler/tasks/:id | æ›´æ–°ä»»åŠ¡ |
| DELETE | /api/crawler/tasks/:id | åˆ é™¤ä»»åŠ¡ |
| POST | /api/crawler/tasks/:id/run | æ‰‹åŠ¨è¿è¡Œä»»åŠ¡ |
| GET | /api/crawler/robots | æ£€æŸ¥ robots.txt |

## ğŸ” é»˜è®¤ç®¡ç†å‘˜è´¦å·

```
ç”¨æˆ·åï¼šmoo
å¯†ç ï¼šmootest1212
```

**âš ï¸ é‡è¦ï¼šé¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼**

## ğŸ•·ï¸ çˆ¬è™«åˆè§„è¯´æ˜

æœ¬ç³»ç»Ÿçš„çˆ¬è™«åŠŸèƒ½ä¸¥æ ¼éµå®ˆä»¥ä¸‹åŸåˆ™ï¼š

1. **robots.txt åˆè§„**: è‡ªåŠ¨æ£€æŸ¥å¹¶éµå®ˆç›®æ ‡ç½‘ç«™çš„ robots.txt è§„åˆ™
2. **è¯·æ±‚é¢‘ç‡æ§åˆ¶**: é»˜è®¤ 2 ç§’å»¶è¿Ÿï¼Œé¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆå‹åŠ›
3. **User-Agent æ ‡è¯†**: ä½¿ç”¨æ˜ç¡®çš„ Bot æ ‡è¯†
4. **ä»…é™å…¬å¼€æ•°æ®**: åªçˆ¬å–å…¬å¼€å¯è®¿é—®çš„å•†å“ä¿¡æ¯
5. **æ³•å¾‹åˆè§„**: è¯·ç¡®ä¿çˆ¬å–è¡Œä¸ºç¬¦åˆå½“åœ°æ³•å¾‹æ³•è§„

### é…ç½®çˆ¬è™«

åœ¨ç®¡ç†åå°çš„"çˆ¬è™«ç³»ç»Ÿ"é¡µé¢ï¼š
1. ç‚¹å‡»"æ–°å»ºä»»åŠ¡"
2. è¾“å…¥ä»»åŠ¡åç§°å’Œç›®æ ‡ URL
3. å¯é€‰ï¼šè®¾ç½®å®šæ—¶è°ƒåº¦ (Cron è¡¨è¾¾å¼)
4. ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æŸ¥ robots.txt
5. ç‚¹å‡»"åˆ›å»ºä»»åŠ¡"
6. ç‚¹å‡»"è¿è¡Œ"å¼€å§‹çˆ¬å–

## ğŸ“ é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/       # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ authController.js
â”‚   â”‚   â”œâ”€â”€ productController.js
â”‚   â”‚   â”œâ”€â”€ userController.js
â”‚   â”‚   â””â”€â”€ crawlerController.js
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â””â”€â”€ logger.js
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ database.js
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â”œâ”€â”€ products.js
â”‚   â”‚   â”œâ”€â”€ users.js
â”‚   â”‚   â””â”€â”€ crawler.js
â”‚   â”œâ”€â”€ services/          # æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ crawler.js
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ initDb.js
â”‚   â”‚   â””â”€â”€ seedAdmin.js
â”‚   â””â”€â”€ server.js          # ä¸»æœåŠ¡å™¨
â”œâ”€â”€ admin/                 # ç®¡ç†åå°å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â””â”€â”€ main.jsx
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ data/                  # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡
â””â”€â”€ package.json
```

## ğŸ”§ ç¯å¢ƒå˜é‡

```bash
# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# JWT é…ç½®
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=24h

# ç®¡ç†å‘˜è´¦å·
ADMIN_USERNAME=moo
ADMIN_PASSWORD=mootest1212

# æ•°æ®åº“
DATABASE_PATH=./data/fashion.db

# çˆ¬è™«é…ç½®
CRAWLER_CONCURRENT=3
CRAWLER_DELAY_MS=2000
CRAWLER_USER_AGENT=Mozilla/5.0 (compatible; FashionBot/1.0)

# æ—¥å¿—
LOG_LEVEL=info
LOG_FILE=./logs/app.log
```

## ğŸ“ å¼€å‘è¯´æ˜

### æ·»åŠ æ–°çš„çˆ¬è™«æº

ç¼–è¾‘ `src/services/crawler.js` ä¸­çš„ `extractProductData` å‡½æ•°ï¼Œæ ¹æ®ç›®æ ‡ç½‘ç«™ç»“æ„è°ƒæ•´é€‰æ‹©å™¨ã€‚

### è‡ªå®šä¹‰å•†å“å­—æ®µ

ç¼–è¾‘ `src/models/database.js` ä¸­çš„äº§å“è¡¨ç»“æ„ï¼Œæ·»åŠ æ‰€éœ€å­—æ®µã€‚

### æ‰©å±• API

åœ¨ `src/routes/` ä¸­æ·»åŠ æ–°çš„è·¯ç”±æ–‡ä»¶ï¼Œå¹¶åœ¨ `src/server.js` ä¸­æ³¨å†Œã€‚

## ğŸ¤ ä¸å‰ç«¯é›†æˆ

å‰ç«¯é¡¹ç›®éœ€è¦é…ç½® API åŸºç¡€ URLï¼š

```javascript
// åœ¨å‰ç«¯é¡¹ç›®ä¸­
const API_BASE = 'http://localhost:3000/api';

// è·å–å•†å“åˆ—è¡¨
const response = await fetch(`${API_BASE}/products`);
const data = await response.json();
```

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ç‰ˆæœ¬**: 1.0.0
**æ„å»ºæ—¶é—´**: 2026-02-22
